# Java ë™ì‹œì„± ì»¬ë ‰ì…˜ ë° ë½ ê°œë… ì •ë¦¬

## ì»¬ë ‰ì…˜ ë¹„êµ

### Vector vs ArrayList vs CopyOnWriteArrayList

| í•­ëª© | Vector | ArrayList | CopyOnWriteArrayList |
|------|--------|-----------|----------------------|
| **ë™ê¸°í™”** | âœ… ì „ì²´ ë©”ì„œë“œì— `synchronized` | âŒ ë™ê¸°í™” ì•ˆ ë¨ | âœ… ë‚´ë¶€ ë³µì‚¬ë¡œ ë™ê¸°í™” |
| **ì„±ëŠ¥** | ëŠë¦¼ (ì „ì—­ ë½) | ë¹ ë¦„ | ì½ê¸° ë¹ ë¦„, ì“°ê¸° ëŠë¦¼ |
| **ë™ì‹œ ì“°ê¸°** | âŒ ë½ ëŒ€ê¸°ë¡œ ë¶ˆê°€ | âŒ ë¬¸ì œ ë°œìƒ | âŒ ì“°ê¸° ì†ì‹¤ ê°€ëŠ¥ì„± ìˆìŒ |
| **íŠ¹ì§•** | ë ˆê±°ì‹œ, ì“°ë ˆë“œ ì•ˆì „ | ì¼ë°˜ì  ìš©ë„ì— ì í•© | ì½ê¸° ë§ê³  ì“°ê¸° ì ì„ ë•Œ |

> ğŸ”¥ **Vector**ëŠ” ì „ì—­ ë½ìœ¼ë¡œ ì•ˆì „í•˜ì§€ë§Œ ëŠë¦¬ë©°, **CopyOnWriteArrayList**ëŠ” ì½ê¸° ì„±ëŠ¥ì´ ë›°ì–´ë‚˜ì§€ë§Œ ì“°ê¸° ì†ì‹¤ ê°€ëŠ¥ì„± ì¡´ì¬.

### CopyOnWriteArrayListì˜ ë¬¸ì œì 
* ëª¨ë“  ì“°ê¸° ì—°ì‚°(`add`, `remove`)ì´ ë‚´ë¶€ ë°°ì—´ì„ **ë³µì‚¬**í•˜ê³  êµì²´í•˜ì—¬ ë™ê¸°í™”
* ë™ì‹œ ì“°ê¸° ì‹œ, **Lost Update(ì“°ê¸°ê°€ ë®ì–´ì¨ì§)** ë°œìƒ ê°€ëŠ¥
* ì“°ê¸° ì¶©ëŒ ë°œìƒ ì‹œ ë³‘í•©(Merge)ì´ ì—†ìœ¼ë©° ë§ˆì§€ë§‰ ì“°ê¸° ê²°ê³¼ë§Œ ë°˜ì˜

> âœ”ï¸ "ë™ê¸°í™” â‰  ë™ì‹œì„± ë¬¸ì œ í•´ê²°"

### addì™€ removeì˜ ë™ì‹œ ê°€ëŠ¥ ì—¬ë¶€

| ì»¬ë ‰ì…˜ | ë™ì‹œ ì‹¤í–‰ ê°€ëŠ¥ ì—¬ë¶€ | ì´ìœ  |
|--------|-------------------|------|
| **Vector** | âŒ ë¶ˆê°€ëŠ¥ | ì „ì²´ ë©”ì„œë“œì— `synchronized` |
| **ArrayList** | âŒ ìœ„í—˜ | ë™ê¸°í™” ì—†ìŒ â†’ ê²½ìŸ ìƒíƒœ ë°œìƒ |
| **CopyOnWriteArrayList** | âœ… ê°€ëŠ¥í•˜ë‚˜ ì‹ ë¢° ë¶ˆê°€ | ë³µì‚¬-êµì²´ êµ¬ì¡°, ë³‘í•© ì—†ìŒ |
| **ConcurrentLinkedQueue** | âœ… ê°€ëŠ¥ | Lock-free êµ¬ì¡°, ì†ì‹¤ ì—†ìŒ |

## ë™ê¸°í™” ë°©ì‹

### synchronized í‚¤ì›Œë“œì˜ ë³¸ì§ˆ

#### ë©”ì„œë“œ ë‹¨ìœ„ `synchronized`
```java
public synchronized void foo() {
    // ê°ì²´(this)ì— ë½
}
```
* ê°™ì€ ê°ì²´ì˜ ë‹¤ë¥¸ synchronized ë©”ì„œë“œë„ ë™ì‹œì— ì‹¤í–‰ ë¶ˆê°€

#### í´ë˜ìŠ¤ ë‹¨ìœ„ `static synchronized`
```java
public static synchronized void bar() {
    // í´ë˜ìŠ¤ ë‹¨ìœ„ ë½
}
```
* í´ë˜ìŠ¤ ì „ì²´ì— ë½ì„ ê±¸ì–´ ë™ê¸°í™”

### Vector ë™ê¸°í™” ë°©ì‹
* ëª¨ë“  `add()`, `remove()`, `get()` ì‘ì—…ì— ì „ì—­ ë½ ì ìš© â†’ **ì•ˆì „í•˜ì§€ë§Œ ëŠë¦¼**
* í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œê°€ ì‘ì—… ì¤‘ì´ë©´ ë‹¤ë¥¸ ìŠ¤ë ˆë“œëŠ” ëŒ€ê¸°


## í•„ë“œ ë‹¨ìœ„ ë½

### ë°©ë²• 1: Custom Lock ì‚¬ìš©
```java
private final Object fieldLock = new Object();
private int counter = 0;

public void increment() {
    synchronized (fieldLock) {
        counter++;
    }
}
```

### ë°©ë²• 2: ReentrantLock ì‚¬ìš©
```java
private final ReentrantLock counterLock = new ReentrantLock();
private int counter = 0;

public void increment() {
    counterLock.lock();
    try {
        counter++;
    } finally {
        counterLock.unlock();
    }
}
```
* **ReentrantLock**ì€ ì¡°ê±´ ë³€ìˆ˜(Condition), íƒ€ì„ì•„ì›ƒ ë½, ê³µì •ì„± ì„¤ì • ê°€ëŠ¥

### ì½ê¸°-ì“°ê¸° ë¶„ë¦¬ ê°€ëŠ¥ ë½
* **ReadWriteLock** ë˜ëŠ” **StampedLock**ì„ ì‚¬ìš©í•˜ë©´ **ì½ê¸°-ì“°ê¸° ë™ì‹œ ì²˜ë¦¬** ê°€ëŠ¥

## í•µì‹¬ ìš”ì•½
* **Vector**: ì „ì—­ ë½ ì ìš© â†’ ì•ˆì „í•˜ì§€ë§Œ ëŠë¦¼
* **CopyOnWriteArrayList**: ì½ê¸° ìµœì í™”, ì“°ê¸° ì†ì‹¤ ê°€ëŠ¥ì„± ìˆìŒ
* **synchronized**: ê°ì²´ ë‹¨ìœ„ë¡œ ë½ì„ ê±¸ì–´ ë™ê¸°í™”
* **ReentrantLock** ë“± ê³ ê¸‰ ë½ìœ¼ë¡œ ë” ì •êµí•œ ë™ê¸°í™” ê°€ëŠ¥
* ì™„ë²½í•œ ë™ì‹œì„± ì²˜ë¦¬ë¥¼ ìœ„í•´ **Concurrent ê³„ì—´ ì»¬ë ‰ì…˜** í™œìš© ê¶Œì¥